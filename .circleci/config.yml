version: 2.1
orbs:
  newman: postman/newman@0.0.2
jobs:
  newman-collection-run:
    executor: newman/postman-newman-docker
    steps:
       - checkout
       - newman/newman-run:
            collection: ./DEX_DEV.postman_collection.json
            environment: ./DEV.postman_environment.json
orbs:
  slack: circleci/slack@x.y.z/*

jobs:
    steps:
      # With fail_only set to `true`, no alert will be sent in this example. Change the exit status on the next line to produce an error.
      - run: exit 0

      - slack/status:
          fail_only: true # Optional: if set to `true` then only failure messages will occur.
          webhook: "webhook" # Optional: Enter a specific webhook here or the default will use $SLACK_WEBHOOK
          only_for_branches: "master"

workflows:
  version: 2.1
  #schedule-workflow: 
    triggers:
      - schedule:
          cron: "0 6,12,18,0 * * *"
          filters:
            branches:
              only:
                - master
    jobs:
      - newman-collection-run:
          context: BarrelSandbox
  deploy:
    jobs:
      - newman-collection-run:
          context: BarrelSandbox
